webpackJsonp([0],{

/***/ 19:
/* unknown exports provided */
/* all exports used */
/*!*****************!*\
  !*** ./main.js ***!
  \*****************/
/***/ (function(module, exports, __webpack_require__) {

eval("const getUserMedia = __webpack_require__(/*! getusermedia */ 7);\nconst Peer = __webpack_require__(/*! simple-peer */ 8);\n\nlet SERVER_ADDRESS = 'https://gr.itguy.ir:9443';\nlet roomName = getParameterByName('r');\nvar peer, socket;\n\n// helpers\n// pre: url and parameter name\n// post: returns parameter value\nfunction getParameterByName(name, url) {\n  if (!url) {\n    url = window.location.href;\n  }\n  name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n  var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n      results = regex.exec(url);\n  if (!results) return null;\n  if (!results[2]) return null;\n  return convertToSlug(decodeURIComponent(results[2].replace(/\\+/g, \" \")));\n}\n\n// converts string to one word\nfunction convertToSlug(Text) {\n  return Text.toLowerCase().replace(/[^\\w ]+/g, '').replace(/ +/g, '-');\n}\n\n// populate the room name if available\nif (roomName != null) {\n  document.getElementById('room').setAttribute(\"value\", roomName);\n}\n\ndocument.getElementById('setup').addEventListener('submit', e => {\n  e.preventDefault();\n  roomName = document.getElementById('room').value;\n  if (roomName.length > 1) {\n    let options = {\n      audio: document.getElementById('audio').checked,\n      video: document.getElementById('video').checked\n    };\n    console.log(options);\n    start(options);\n    document.querySelector('h2').textContent = 'Welcome to room: ' + roomName;\n  } else {\n    alert('Enter a room name');\n  };\n});\n\n// function cleanRoom(socket){\n//   socket.emit('sig:clean')\n// }\n\nfunction watchForData() {\n  document.getElementById('send').disabled = false;\n  document.getElementById('chat').addEventListener('submit', function (e) {\n    e.preventDefault();\n    let yourMessage = document.getElementById('yourMessage');\n    peer.send(yourMessage.value);\n    document.getElementById('messages').textContent += yourMessage.value + '\\n';\n    yourMessage.value = null;\n  });\n\n  peer.on('data', function (data) {\n    document.getElementById('messages').textContent += data + '\\n';\n  });\n\n  peer.on('stream', function (stream) {\n    let player = document.getElementById('player');\n\n    player.src = window.URL.createObjectURL(stream);\n    player.play();\n  });\n};\n\nfunction start(options) {\n\n  // connect to main socket server\n  socket = io(SERVER_ADDRESS);\n  socket.on('connect', function () {\n    console.log('Connected to socket');\n  });\n\n  console.log('welcome to room', roomName);\n\n  getUserMedia(options, function (err, stream) {\n    if (err) return console.error(err);\n\n    socket.emit('sig:ready', roomName);\n    console.log('sent ready');\n\n    socket.on('sig:init', function () {\n      console.log('got init');\n      peer = new Peer({\n        initiator: true,\n        trickle: false,\n        stream: stream\n      });\n      peer.on('signal', function (data) {\n        socket.emit('sig:offer', JSON.stringify(data));\n        console.log('sent offer', data);\n      });\n    });\n\n    socket.on('sig:accept', function (accept) {\n      accept = JSON.parse(accept);\n      peer.signal(accept);\n      console.log('got accept', accept);\n      watchForData();\n    });\n\n    socket.on('sig:offer', function (offer) {\n      offer = JSON.parse(offer);\n      console.log('got offer', offer);\n      peer = new Peer({\n        initiator: false,\n        trickle: false,\n        stream: stream\n      });\n      peer.on('signal', function (data) {\n        socket.emit('sig:accept', JSON.stringify(data));\n        console.log('sent accept', data);\n      });\n      peer.signal(offer);\n      watchForData();\n    });\n  }); // end of getUserMedia\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaWVudC9tYWluLmpzPzlhMzIiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2V0VXNlck1lZGlhID0gcmVxdWlyZSgnZ2V0dXNlcm1lZGlhJyk7XG5jb25zdCBQZWVyID0gcmVxdWlyZSgnc2ltcGxlLXBlZXInKTtcblxubGV0IFNFUlZFUl9BRERSRVNTID0gJ2h0dHBzOi8vZ3IuaXRndXkuaXI6OTQ0Myc7XG5sZXQgcm9vbU5hbWUgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ3InKTtcbnZhciBwZWVyLCBzb2NrZXQ7XG5cblxuXG4vLyBoZWxwZXJzXG4vLyBwcmU6IHVybCBhbmQgcGFyYW1ldGVyIG5hbWVcbi8vIHBvc3Q6IHJldHVybnMgcGFyYW1ldGVyIHZhbHVlXG5mdW5jdGlvbiBnZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSwgdXJsKSB7XG4gICAgaWYgKCF1cmwpIHtcbiAgICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgIH1cbiAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCBcIlxcXFwkJlwiKTtcbiAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiWz8mXVwiICsgbmFtZSArIFwiKD0oW14mI10qKXwmfCN8JClcIiksXG4gICAgICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XG4gICAgaWYgKCFyZXN1bHRzKSByZXR1cm4gbnVsbDtcbiAgICBpZiAoIXJlc3VsdHNbMl0pIHJldHVybiBudWxsO1xuICAgIHJldHVybiBjb252ZXJ0VG9TbHVnKGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCBcIiBcIikpKTtcbn1cblxuLy8gY29udmVydHMgc3RyaW5nIHRvIG9uZSB3b3JkXG5mdW5jdGlvbiBjb252ZXJ0VG9TbHVnKFRleHQpXG57XG4gICAgcmV0dXJuIFRleHRcbiAgICAgICAgLnRvTG93ZXJDYXNlKClcbiAgICAgICAgLnJlcGxhY2UoL1teXFx3IF0rL2csJycpXG4gICAgICAgIC5yZXBsYWNlKC8gKy9nLCctJylcbiAgICAgICAgO1xufVxuXG4vLyBwb3B1bGF0ZSB0aGUgcm9vbSBuYW1lIGlmIGF2YWlsYWJsZVxuaWYgKHJvb21OYW1lICE9IG51bGwpIHtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb20nKS5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLHJvb21OYW1lKVxufVxuXG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR1cCcpLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGUgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHJvb21OYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb20nKS52YWx1ZTtcbiAgaWYgKHJvb21OYW1lLmxlbmd0aCA+IDEpIHtcbiAgICBsZXQgb3B0aW9ucyA9IHtcbiAgICAgIGF1ZGlvOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXVkaW8nKS5jaGVja2VkLFxuICAgICAgdmlkZW86IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlbycpLmNoZWNrZWRcbiAgICB9O1xuICAgIGNvbnNvbGUubG9nKG9wdGlvbnMpO1xuICAgIHN0YXJ0KG9wdGlvbnMpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykudGV4dENvbnRlbnQgPSAnV2VsY29tZSB0byByb29tOiAnICsgcm9vbU5hbWU7XG4gIH1lbHNle1xuICAgIGFsZXJ0KCdFbnRlciBhIHJvb20gbmFtZScpO1xuICB9O1xufSk7XG5cblxuXG4vLyBmdW5jdGlvbiBjbGVhblJvb20oc29ja2V0KXtcbi8vICAgc29ja2V0LmVtaXQoJ3NpZzpjbGVhbicpXG4vLyB9XG5cbmZ1bmN0aW9uIHdhdGNoRm9yRGF0YSgpe1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VuZCcpLmRpc2FibGVkID0gZmFsc2U7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0JykuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7ICAgIFxuICAgIGxldCB5b3VyTWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd5b3VyTWVzc2FnZScpO1xuICAgIHBlZXIuc2VuZCh5b3VyTWVzc2FnZS52YWx1ZSk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lc3NhZ2VzJykudGV4dENvbnRlbnQgKz0geW91ck1lc3NhZ2UudmFsdWUgKyAnXFxuJztcbiAgICB5b3VyTWVzc2FnZS52YWx1ZSA9IG51bGw7XG5cbiAgfSlcblxuICBwZWVyLm9uKCdkYXRhJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVzc2FnZXMnKS50ZXh0Q29udGVudCArPSBkYXRhICsgJ1xcbic7XG4gIH0pXG5cbiAgcGVlci5vbignc3RyZWFtJywgZnVuY3Rpb24gKHN0cmVhbSkge1xuICAgIGxldCBwbGF5ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyJyk7XG5cbiAgICBwbGF5ZXIuc3JjID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKVxuICAgIHBsYXllci5wbGF5KClcbiAgfSlcbn07XG5cblxuZnVuY3Rpb24gc3RhcnQob3B0aW9ucyl7XG5cbiAgLy8gY29ubmVjdCB0byBtYWluIHNvY2tldCBzZXJ2ZXJcbiAgc29ja2V0ID0gaW8oU0VSVkVSX0FERFJFU1MpO1xuICBzb2NrZXQub24oJ2Nvbm5lY3QnLCBmdW5jdGlvbigpe1xuICAgIGNvbnNvbGUubG9nKCdDb25uZWN0ZWQgdG8gc29ja2V0Jyk7XG4gIH0pO1xuXG4gIGNvbnNvbGUubG9nKCd3ZWxjb21lIHRvIHJvb20nICwgcm9vbU5hbWUpO1xuXG4gIGdldFVzZXJNZWRpYShvcHRpb25zLCBmdW5jdGlvbiAoZXJyLCBzdHJlYW0pIHtcbiAgICBpZiAoZXJyKSByZXR1cm4gY29uc29sZS5lcnJvcihlcnIpO1xuXG4gICAgc29ja2V0LmVtaXQoJ3NpZzpyZWFkeScscm9vbU5hbWUpO1xuICAgIGNvbnNvbGUubG9nKCdzZW50IHJlYWR5Jyk7XG5cbiAgICBzb2NrZXQub24oJ3NpZzppbml0JyxmdW5jdGlvbigpe1xuICAgICAgY29uc29sZS5sb2coJ2dvdCBpbml0Jyk7XG4gICAgICBwZWVyID0gbmV3IFBlZXIoe1xuICAgICAgICBpbml0aWF0b3I6IHRydWUsXG4gICAgICAgIHRyaWNrbGU6IGZhbHNlLFxuICAgICAgICBzdHJlYW06IHN0cmVhbVxuICAgICAgfSk7XG4gICAgICBwZWVyLm9uKCdzaWduYWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBzb2NrZXQuZW1pdCgnc2lnOm9mZmVyJywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICBjb25zb2xlLmxvZygnc2VudCBvZmZlcicsIGRhdGEpOyAgICAgXG4gICAgICB9KVxuICAgIH0pO1xuXG5cbiAgICBzb2NrZXQub24oJ3NpZzphY2NlcHQnLCBmdW5jdGlvbihhY2NlcHQpe1xuICAgICAgYWNjZXB0ID0gSlNPTi5wYXJzZShhY2NlcHQpO1xuICAgICAgcGVlci5zaWduYWwoYWNjZXB0KTtcbiAgICAgIGNvbnNvbGUubG9nKCdnb3QgYWNjZXB0JyxhY2NlcHQpO1xuICAgICAgd2F0Y2hGb3JEYXRhKCk7XG4gICAgfSk7XG5cblxuICAgIHNvY2tldC5vbignc2lnOm9mZmVyJywgZnVuY3Rpb24ob2ZmZXIpe1xuICAgICAgb2ZmZXIgPSBKU09OLnBhcnNlKG9mZmVyKTtcbiAgICAgIGNvbnNvbGUubG9nKCdnb3Qgb2ZmZXInLG9mZmVyKTtcbiAgICAgIHBlZXIgPSBuZXcgUGVlcih7XG4gICAgICAgIGluaXRpYXRvcjogZmFsc2UsXG4gICAgICAgIHRyaWNrbGU6IGZhbHNlLFxuICAgICAgICBzdHJlYW06IHN0cmVhbVxuICAgICAgfSk7XG4gICAgICBwZWVyLm9uKCdzaWduYWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBzb2NrZXQuZW1pdCgnc2lnOmFjY2VwdCcsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3NlbnQgYWNjZXB0JywgZGF0YSk7ICAgICBcbiAgICAgIH0pXG4gICAgICBwZWVyLnNpZ25hbChvZmZlcik7XG4gICAgICB3YXRjaEZvckRhdGEoKTtcbiAgICB9KTtcblxuXG4gIH0pOyAvLyBlbmQgb2YgZ2V0VXNlck1lZGlhXG5cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvY2xpZW50L21haW4uanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBIiwic291cmNlUm9vdCI6IiJ9");

/***/ })

},[19]);